<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Olive Young è³¼ç‰©æ¸…å–® Pro</title>
    <style>
        :root { --primary: #f05a28; --secondary: #97c024; --bought: #6c757d; --bg: #f2f2f7; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); margin: 0; padding: 10px; padding-bottom: 50px; }
        .card { background: white; border-radius: 16px; padding: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 15px; }
        h2 { color: var(--primary); text-align: center; font-size: 22px; margin: 10px 0; }
        
        .form-group { display: flex; flex-direction: column; gap: 10px; }
        input, select { padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; outline: none; background: white; -webkit-appearance: none; }
        .row { display: flex; gap: 8px; }
        .btn-main { background: var(--primary); color: white; padding: 15px; border: none; border-radius: 10px; font-weight: bold; font-size: 16px; cursor: pointer; }
        
        /* ç¯©é¸ Tab */
        .filter-tabs { display: flex; gap: 8px; margin-bottom: 15px; overflow-x: auto; padding: 5px 0; scrollbar-width: none; }
        .tab { flex: 0 0 auto; padding: 8px 16px; background: white; border-radius: 20px; font-size: 14px; font-weight: 600; color: #666; cursor: pointer; border: 1px solid #eee; }
        .tab.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* ç”¢å“å¡ç‰‡ */
        .item-card { background: white; border-radius: 16px; overflow: hidden; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: relative; }
        .item-card.is-bought { opacity: 0.6; filter: grayscale(0.8); }
        .prod-img { width: 100%; height: 200px; object-fit: contain; background: #fff; }
        .prod-content { padding: 15px; }
        .category-path { font-size: 11px; color: var(--secondary); font-weight: bold; text-transform: uppercase; margin-bottom: 5px; display: block; }
        .prod-title { font-size: 18px; font-weight: bold; color: #222; text-decoration: none; display: block; margin-bottom: 8px; }
        
        .price-row { display: flex; align-items: baseline; gap: 8px; margin-bottom: 12px; }
        .price-sale { color: #e74c3c; font-size: 22px; font-weight: 800; }
        .price-orig { color: #aaa; text-decoration: line-through; font-size: 14px; }

        .status-badge { display: inline-block; padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: bold; margin-bottom: 10px; }
        .status-æ„Ÿèˆˆè¶£ { background: #e3f2fd; color: #1976d2; }
        .status-æƒ³è³¼è²· { background: #fff3e0; color: #f57c00; }
        .status-è€ƒæ…®è³¼è²· { background: #f3e5f5; color: #7b1fa2; }
        .status-å·²è³¼è²· { background: #e8f5e9; color: #2e7d32; }

        .quick-status { width: 100%; margin-top: 10px; border: 1px solid #eee; padding: 8px; border-radius: 8px; font-size: 14px; }

        .actions { display: flex; gap: 10px; margin-top: 15px; border-top: 1px solid #f5f5f5; padding-top: 15px; }
        .btn-action { flex: 1; padding: 10px; border-radius: 8px; border: none; font-size: 13px; font-weight: bold; cursor: pointer; }
        .edit { background: #f0f0f0; color: #444; }
        .del { background: #fff0f0; color: #d32f2f; }
    </style>
</head>
<body>

<div class="card">
    <h2 id="form-title">Olive Young é¡˜æœ›æ¸…å–® ğŸŒ¿</h2>
    <div class="form-group">
        <input type="hidden" id="edit-id">
        <input type="text" id="name" placeholder="ç”¢å“åç¨±">
        <input type="text" id="imgUrl" placeholder="åœ–ç‰‡ç¶²å€">
        
        <div class="row">
            <select id="mainCat" onchange="updateSubCat()">
                <option value="è­·è†šå“">è­·è†šå“</option>
                <option value="åŒ–å¦å“">åŒ–å¦å“</option>
                <option value="å…¶ä»–">å…¶ä»–</option>
            </select>
            <select id="subCat"></select>
        </div>

        <select id="status">
            <option value="æ„Ÿèˆˆè¶£">æ„Ÿèˆˆè¶£</option>
            <option value="æƒ³è³¼è²·">ğŸ”¥ æƒ³è³¼è²·</option>
            <option value="è€ƒæ…®è³¼è²·">ğŸ¤” è€ƒæ…®è³¼è²·</option>
            <option value="å·²è³¼è²·">âœ… å·²è³¼è²·</option>
        </select>

        <input type="text" id="url" placeholder="ç”¢å“å®˜ç¶²é€£çµ">
        <div class="row">
            <input type="text" id="origPrice" placeholder="åŸåƒ¹ â‚©">
            <input type="text" id="salePrice" placeholder="ç‰¹åƒ¹ â‚©">
        </div>
        <button class="btn-main" onclick="saveProduct()">å„²å­˜ç”¢å“</button>
        <button id="cancel-edit" style="display:none; background:#666; margin-top:5px; padding:12px; border-radius:10px; border:none; color:white;" onclick="resetForm()">å–æ¶ˆç·¨è¼¯</button>
    </div>
</div>

<div class="filter-tabs">
    <div class="tab active" onclick="filterList('å…¨éƒ¨', this)">å…¨éƒ¨</div>
    <div class="tab" onclick="filterList('æƒ³è³¼è²·', this)">ğŸ”¥ å¿…è²·</div>
    <div class="tab" onclick="filterList('æœªè³¼è²·', this)">ğŸ›’ æœªè²·</div>
    <div class="tab" onclick="filterList('å·²è³¼è²·', this)">âœ… å·²è²·</div>
</div>

<div id="list"></div>

<script>
    let db = JSON.parse(localStorage.getItem('oy_ultimate_db')) || [];
    let currentFilter = 'å…¨éƒ¨';

    const categories = {
        "è­·è†šå“": ["Toner", "Lotion", "Cream", "Mask", "Cleanser", "Serum", "Sun Care"],
        "åŒ–å¦å“": ["Base", "Foundation", "Cushion", "Powder", "Lip Tint", "Lipstick", "Lip Pencil", "Eyebrow", "Eyeliner", "Eye Shadow", "Highlighter", "Shading", "Blush", "Fixer"],
        "å…¶ä»–": ["Body Care", "Hair Care", "Beauty Tools", "Fragrance"]
    };

    function updateSubCat() {
        const main = document.getElementById('mainCat').value;
        const sub = document.getElementById('subCat');
        sub.innerHTML = categories[main].map(c => `<option value="${c}">${c}</option>`).join('');
    }

    function saveProduct() {
        const id = document.getElementById('edit-id').value;
        const name = document.getElementById('name').value;
        const imgUrl = document.getElementById('imgUrl').value;
        const mainCat = document.getElementById('mainCat').value;
        const subCat = document.getElementById('subCat').value;
        const status = document.getElementById('status').value;
        const url = document.getElementById('url').value;
        const origPrice = document.getElementById('origPrice').value;
        const salePrice = document.getElementById('salePrice').value;

        if (!name) return alert('è«‹è¼¸å…¥ç”¢å“åç¨±');

        const product = { id: id ? Number(id) : Date.now(), name, imgUrl, mainCat, subCat, status, url, origPrice, salePrice };

        if (id) {
            const idx = db.findIndex(p => p.id == id);
            db[idx] = product;
        } else {
            db.push(product);
        }

        localStorage.setItem('oy_ultimate_db', JSON.stringify(db));
        resetForm();
        render();
    }

    function render() {
        const container = document.getElementById('list');
        container.innerHTML = '';
        
        let filtered = db;
        if (currentFilter === 'æœªè³¼è²·') filtered = db.filter(p => p.status !== 'å·²è³¼è²·');
        else if (currentFilter === 'å·²è³¼è²·') filtered = db.filter(p => p.status === 'å·²è³¼è²·');
        else if (currentFilter === 'æƒ³è³¼è²·') filtered = db.filter(p => p.status === 'æƒ³è³¼è²·');

        filtered.sort((a,b) => b.id - a.id).forEach(p => {
            container.innerHTML += `
                <div class="item-card ${p.status === 'å·²è³¼è²·' ? 'is-bought' : ''}">
                    ${p.imgUrl ? `<img src="${p.imgUrl}" class="prod-img" onerror="this.style.display='none'">` : ''}
                    <div class="prod-content">
                        <span class="category-path">${p.mainCat} > ${p.subCat}</span>
                        <a href="${p.url || '#'}" target="_blank" class="prod-title">${p.name}</a>
                        
                        <div class="price-row">
                            <span class="price-sale">â‚©${p.salePrice || '??'}</span>
                            <span class="price-orig">â‚©${p.origPrice || '--'}</span>
                        </div>

                        <span class="status-badge status-${p.status}">${p.status}</span>

                        <select class="quick-status" onchange="updateStatus(${p.id}, this.value)">
                            <option value="æ„Ÿèˆˆè¶£" ${p.status==='æ„Ÿèˆˆè¶£'?'selected':''}>æ„Ÿèˆˆè¶£</option>
                            <option value="æƒ³è³¼è²·" ${p.status==='æƒ³è³¼è²·'?'selected':''}>æƒ³è³¼è²·</option>
                            <option value="è€ƒæ…®è³¼è²·" ${p.status==='è€ƒæ…®è³¼è²·'?'selected':''}>è€ƒæ…®è³¼è²·</option>
                            <option value="å·²è³¼è²·" ${p.status==='å·²è³¼è²·'?'selected':''}>å·²è³¼è²·</option>
                        </select>

                        <div class="actions">
                            <button class="btn-action edit" onclick="edit(${p.id})">ç·¨è¼¯</button>
                            <button class="btn-action del" onclick="del(${p.id})">åˆªé™¤</button>
                        </div>
                    </div>
                </div>
            `;
        });
    }

    function updateStatus(id, newStatus) {
        const idx = db.findIndex(p => p.id == id);
        db[idx].status = newStatus;
        localStorage.setItem('oy_ultimate_db', JSON.stringify(db));
        render();
    }

    function filterList(type, el) {
        currentFilter = type;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        el.classList.add('active');
        render();
    }

    function edit(id) {
        const p = db.find(x => x.id == id);
        document.getElementById('edit-id').value = p.id;
        document.getElementById('name').value = p.name;
        document.getElementById('imgUrl').value = p.imgUrl;
        document.getElementById('mainCat').value = p.mainCat;
        updateSubCat();
        document.getElementById('subCat').value = p.subCat;
        document.getElementById('status').value = p.status;
        document.getElementById('url').value = p.url;
        document.getElementById('origPrice').value = p.origPrice;
        document.getElementById('salePrice').value = p.salePrice;
        document.getElementById('form-title').innerText = "ç·¨è¼¯å•†å“é …ç›®";
        document.getElementById('cancel-edit').style.display = "block";
        window.scrollTo({top: 0, behavior: 'smooth'});
    }

    function del(id) {
        if(confirm('ç¢ºå®šè¦å¾æ¸…å–®ä¸­ç§»é™¤å—ï¼Ÿ')) {
            db = db.filter(x => x.id !== id);
            localStorage.setItem('oy_ultimate_db', JSON.stringify(db));
            render();
        }
    }

    function resetForm() {
        document.getElementById('edit-id').value = '';
        document.querySelectorAll('input').forEach(i => i.value = '');
        document.getElementById('form-title').innerText = "Olive Young é¡˜æœ›æ¸…å–® ğŸŒ¿";
        document.getElementById('cancel-edit').style.display = "none";
        updateSubCat();
    }

    updateSubCat();
    render();
</script>

</body>
</html>
